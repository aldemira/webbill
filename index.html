<!DOCTYPE html>
<html>
<head>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <!--
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
    -->
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
    <script>
        var config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            backgroundColor: '#ffffff',
            // Set this for game-over
            // backgroundColor: '#4488aa',
            physics: {
                default: 'arcade',
                    arcade: {
                        gravity: { z: 200 }
                        }
                    },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                },
            };

    var game = new Phaser.Game(config);
    var maxBILLS = 100;
    var maxComputers = 20;
    var computers = ["maccpu","nextcpu","cgicpu","suncpu","palmcpu","os2cpu","bsdcpu"];

    function preload ()
    {
        // Load CPU images
        this.load.image("maccpu", "images/maccpu.png");
        this.load.image("nextcpu", "images/nextcpu.png");
        this.load.image("sgicpu", "images/sgicpu.png");
        this.load.image("suncpu", "images/suncpu.png");
        this.load.image("palmcpu", "images/palmcpu.png");
        this.load.image("os2cpu", "images/os2cpu.png");
        this.load.image("bsdcpu", "images/bsdcpu.png");
        // Load toaster
        this.load.image("toaster", "images/toaster.png");
        // Load bucket
        this.load.image("bucket", "images/bucket.png");
        // Load OS Images
    }

    function create ()
    {
        var curLevel = 1;
        var t = this;
        networkCreate(this, curLevel);

    }

    function update()
    {
    }

    function networkCreate(t, myLevel)
    {
        var curCompNum = Math.min(8 + myLevel, maxComputers);
        var virtCanvasX = 0;
        var virtCanvasY = 0;
        var cpuIndex = 0;
        var curCableNum = Math.min(myLevel, curCompNum/2);
        var levelCompArr = [];
        for(var i = 0; i<curCompNum;i++) {
            cpuIndex = Math.floor(Math.random() * computers.length);
            virtCanvasX = Phaser.Math.Between(game.config.width * 0.1, game.config.width * 0.9);
            virtCanvasY = Phaser.Math.Between(game.config.height * 0.1, game.config.height * 0.9);
            levelCompArr.push(t.add.image(virtCanvasX,virtCanvasY,computers[cpuIndex]));
        }

        for (var i = 0; i<curCableNum ; i++) {
            var tComp1ID = Phaser.Math.Between(0, curCompNum-1);
            var tComp2ID = tComp1ID;
            while (tComp1ID == tComp2ID ) {
                tComp2ID = Phaser.Math.Between(0, curCompNum-1);
            }

            levelCompArr[tComp1ID].setDepth(10);
            levelCompArr[tComp2ID].setDepth(10);

            var myLine =  new Phaser.Geom.Line(levelCompArr[tComp1ID].x, levelCompArr[tComp1ID].y, levelCompArr[tComp2ID].x, levelCompArr[tComp2ID].y);
            var graphics = t.add.graphics({ lineStyle: { width: 4, color: 0xaa00aa } });
            graphics.strokeLineShape(myLine);
        }

    }
    </script>
</body>
</html>
